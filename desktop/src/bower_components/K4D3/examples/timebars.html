<!DOCTYPE html>
<html>
    <head>
        <title>Time bars</title>
        <style>
            body {
                font: 10px sans-serif;
                fill: #444;
                background: #f4f4f4;
            }

            .axis line, .axis path {
                fill: none;
                stroke: #ccc;
            }
            .x.axis .minor {
                /*stroke-opacity: .5;*/
            }
            .x.axis path {
                /*display: none;*/
            }

            .y.axis line, .y.axis path {
                fill: none;
                stroke: #ccc;
            }
            rect {
                fill: #fff;
            }
            rect.bordered {
                stroke: rgba(0,0,0,0.3);
                stroke-width:0.5px;
            }
            .block {
                stroke: #444;
                stroke-width:1px;
            }
            g.bargroup {
                overflow: hidden;
                width: 830px;
            }
        </style>
    </head>
    <body>
        <div id="test1"></div>
        <div id="test2"></div>

        <script src="../lib/d3/d3.min.js"></script>
        <script src="../k4.d3.js"></script>

        <script>
        
    
        // test 1 - time data
        var xTimeInterval     =  1000, // time interval in the x-axis data - milliseconds
            transitionInterval =  500, // interval for transition/animation effect
            dataUpdateInterval = 2000, // interval that new data is added to array
            maxBars              = 40; // number of bars to display before shift() exit() begins

        // random data
        function next1() {
            t = t + xTimeInterval;
            return {
                x: t,
                y: Math.sin(t/800) + 1 + Math.random()*2
            };
        }
        var data1 = [],
            now = new Date(),
            t = +now;
        data1.push(next1());
        
        var viz1 = k4.timebars()
        .width(900)
        .height(300)
        //.animatedTransition(true)
        .transitionInterval(transitionInterval)
        .xTimeInterval(xTimeInterval)
        .color("#333")
        .xValue(function(d) { return d.x; })
        .yValue(function(d) { return d.y; });

        function drawChart1() {
            d3.select("#test1")
            .datum(data1)
            .call(viz1);
        }
        drawChart1();

        // start interval to update chart data - dataUpdateInterval
        var i1 = setInterval(function() {
            data1.push(next1());
            d3.timer.flush();
            drawChart1();
            if (data1.length >= maxBars) {
                data1.shift();
            }
        }, dataUpdateInterval);
        
        

        </script>

    </body>
</html>
