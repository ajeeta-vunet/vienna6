<div class="sidebar-item-title">
  {{ groupName }}
</div>

<div class="vis-editor-agg-group" ng-class="groupName">
  <!-- wrapper needed for nesting-indicator -->
  <div ng-repeat="agg in group" class="vis-editor-agg-wrapper">
    <nesting-indicator
      ng-if="groupName === 'buckets'"
      item="agg"
      index="$index"
      list="group">
    </nesting-indicator>

    <!-- agg.html -->
    <vis-editor-agg
      vis="vis"
      saved-vis="savedVis"
      group="group"
      group-name="groupName"
      group-min="stats.min"
      $index="$index"
      agg="agg">
    </vis-editor-agg>
  </div>

  <button
    ng-if="!addForm.visible && stats.count < stats.max"
    type="button"
    ng-click="addForm.visible = true"
    class="vis-editor-agg-add-btn btn btn-xs btn-default" >
    <i class="fa fa-plus"></i>
  </button>

  <div ng-if="addForm.visible" class="vis-editor-agg-add-form form-group">
    <label>Select {{ groupName }} type</label>
    <select
      name="aggType"
      class="form-control"
      ng-model="addForm.selected"
      ng-change="createUsingSchema(addForm.selected)"
      ng-options="schema as schema.title for schema in availableSchema">
    </select>
  </div>
</div>