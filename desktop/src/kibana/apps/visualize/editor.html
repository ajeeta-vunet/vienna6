 <div ng-controller="VisualizeEditor" class="vis-editor">

  <div ng-if="!appEmbedded">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container-fluid">
        <div ng-if="vis.title" class="navbar-header pull-left">
          <span class="navbar-brand">
            {{vis.title}}
          </span>
        </div>

        <ul class="nav navbar-nav pull-right">
          <li><a ng-click="startOver()" class="navbar-link"><i class="fa fa-file-o"></i></a></li>
          <li><a ng-click="toggleSave()" class="navbar-link"><i class="fa fa-save"></i></a></li>
          <li><a ng-click="toggleLoad()" class="navbar-link"><i class="fa fa-folder-open"></i></a></li>
          <li><a ng-click="toggleShare()" class="navbar-link"><i class="fa fa-code"></i></a></li>
          <li><a class="navbar-link" ng-click="doVisualize()"><i class="fa fa-refresh"></i></a></li>
        </ul>

        <form ng-submit="doVisualize()" ng-class="{ 'navbar-form': true, 'first': !vis.title }">
          <div class="form-group">
            <div class="input-group">
              <input
                placeholder="Search..."
                type="text"
                class="form-control ng-pristine ng-valid"
                ng-model="state.query">
              <span class="input-group-addon" ng-click="doVisualize()"><span class="fa fa-search"></span></span>

              <div ng-if="linked && !unlinking"
                ng-dblclick="unlink()"
                tooltip="Double click to unlink this visualization from the saved search"
                class="bitty-modal visualize-linked">
                <i class="fa fa-link"></i>
                &nbsp;
                This visualization is linked to a saved search: <b>{{ vis.savedSearchId | json}}</b> <a href="#/discover/{{ vis.savedSearchId | uriescape }}"><i class="fa fa-pencil" tooltip="Click here to edit the linked saved search"></i></a>
              </div>

              <div ng-if="linked && unlinking" ng-click="doneUnlinking()" class="bitty-modal">
                <i class="fa fa-chain-broken"></i> Unlinked!
              </div>
            </div>
          </div>
        </form>
      </div>
    </nav>
    <config
      config-template="configTemplate"
      config-object="conf">
    </config>
    <div class="container-fluid">
      <div class="row vis-editor-content">
        <div class="vis-sidebar">
          <div class="sidebar-container">
            <form class="sidebar-list" ng-submit="doVisualize()">
              <ul class="list-unstyled">
                <li ng-repeat="category in visConfigCategories.displayOrder" class="sidebar-item">
                  <vis-config-category
                    vis="vis"
                    category="vis[category.name]"
                    fields="fields">
                  </vis-config-category>
                </li>
                <li class="sidebar-item">
                  <div
                    ng-click="doVisualize()"
                    ng-if="vis.dirty"
                    ng-disabled="httpActive.length"
                    class="sidebar-item-button success">
                    Apply
                  </div>
                </li>
              </ul>
            </form>
          </div>
        </div>
        <div class="vis-canvas">
          <vis-canvas><visualize vis="vis"></visualize></vis-canvas>
        </div>
      </div>
    </div>
  </div>

  <div ng-if="appEmbedded" class="container-fluid">
    <div class="row vis-editor-content">
      <div class="vis-canvas">
        <vis-canvas><visualize vis="vis"></visualize></vis-canvas>
      </div>
    </div>
  </div>
</div>